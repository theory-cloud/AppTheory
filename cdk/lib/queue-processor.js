"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AppTheoryQueueProcessor = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
const lambdaEventSources = require("aws-cdk-lib/aws-lambda-event-sources");
const sqs = require("aws-cdk-lib/aws-sqs");
const constructs_1 = require("constructs");
class AppTheoryQueueProcessor extends constructs_1.Construct {
    constructor(scope, id, props) {
        super(scope, id);
        this.queue = new sqs.Queue(this, "Queue", props.queueProps);
        props.consumer.addEventSource(new lambdaEventSources.SqsEventSource(this.queue, {
            batchSize: props.batchSize ?? 10,
            maxBatchingWindow: props.maxBatchingWindow,
        }));
        this.queue.grantConsumeMessages(props.consumer);
    }
}
exports.AppTheoryQueueProcessor = AppTheoryQueueProcessor;
_a = JSII_RTTI_SYMBOL_1;
AppTheoryQueueProcessor[_a] = { fqn: "@theory-cloud/apptheory-cdk.AppTheoryQueueProcessor", version: "0.1.0" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVldWUtcHJvY2Vzc29yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicXVldWUtcHJvY2Vzc29yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBRUEsMkVBQTJFO0FBQzNFLDJDQUEyQztBQUMzQywyQ0FBdUM7QUFTdkMsTUFBYSx1QkFBd0IsU0FBUSxzQkFBUztJQUdwRCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQW1DO1FBQzNFLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFNUQsS0FBSyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQzNCLElBQUksa0JBQWtCLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDaEQsU0FBUyxFQUFFLEtBQUssQ0FBQyxTQUFTLElBQUksRUFBRTtZQUNoQyxpQkFBaUIsRUFBRSxLQUFLLENBQUMsaUJBQWlCO1NBQzNDLENBQUMsQ0FDSCxDQUFDO1FBRUYsSUFBSSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDbEQsQ0FBQzs7QUFoQkgsMERBaUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRHVyYXRpb24gfSBmcm9tIFwiYXdzLWNkay1saWJcIjtcbmltcG9ydCAqIGFzIGxhbWJkYSBmcm9tIFwiYXdzLWNkay1saWIvYXdzLWxhbWJkYVwiO1xuaW1wb3J0ICogYXMgbGFtYmRhRXZlbnRTb3VyY2VzIGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtbGFtYmRhLWV2ZW50LXNvdXJjZXNcIjtcbmltcG9ydCAqIGFzIHNxcyBmcm9tIFwiYXdzLWNkay1saWIvYXdzLXNxc1wiO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSBcImNvbnN0cnVjdHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBBcHBUaGVvcnlRdWV1ZVByb2Nlc3NvclByb3BzIHtcbiAgcmVhZG9ubHkgY29uc3VtZXI6IGxhbWJkYS5GdW5jdGlvbjtcbiAgcmVhZG9ubHkgcXVldWVQcm9wcz86IHNxcy5RdWV1ZVByb3BzO1xuICByZWFkb25seSBiYXRjaFNpemU/OiBudW1iZXI7XG4gIHJlYWRvbmx5IG1heEJhdGNoaW5nV2luZG93PzogRHVyYXRpb247XG59XG5cbmV4cG9ydCBjbGFzcyBBcHBUaGVvcnlRdWV1ZVByb2Nlc3NvciBleHRlbmRzIENvbnN0cnVjdCB7XG4gIHB1YmxpYyByZWFkb25seSBxdWV1ZTogc3FzLlF1ZXVlO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBBcHBUaGVvcnlRdWV1ZVByb2Nlc3NvclByb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIHRoaXMucXVldWUgPSBuZXcgc3FzLlF1ZXVlKHRoaXMsIFwiUXVldWVcIiwgcHJvcHMucXVldWVQcm9wcyk7XG5cbiAgICBwcm9wcy5jb25zdW1lci5hZGRFdmVudFNvdXJjZShcbiAgICAgIG5ldyBsYW1iZGFFdmVudFNvdXJjZXMuU3FzRXZlbnRTb3VyY2UodGhpcy5xdWV1ZSwge1xuICAgICAgICBiYXRjaFNpemU6IHByb3BzLmJhdGNoU2l6ZSA/PyAxMCxcbiAgICAgICAgbWF4QmF0Y2hpbmdXaW5kb3c6IHByb3BzLm1heEJhdGNoaW5nV2luZG93LFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHRoaXMucXVldWUuZ3JhbnRDb25zdW1lTWVzc2FnZXMocHJvcHMuY29uc3VtZXIpO1xuICB9XG59XG5cbiJdfQ==